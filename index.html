<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thermal Studio</title>
    <meta name="description" content="Modern design studio for thermal printers. Create receipts, labels, and notes.">
    
    <link rel="stylesheet" href="css/modern.css">
    <link rel="stylesheet" href="css/log-ui.css">
    <link rel="stylesheet" href="css/features.css">
    
    <!-- Dependencies -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
</head>
<body>
    <header>
        <h1>Thermal Studio</h1>
        <div class="header-controls">
            <div id="batteryIndicator" class="battery-indicator" style="display:none">
                <span>üîã</span> <span id="batteryLevel">--%</span>
            </div>
            <button id="previewBtn" class="btn btn-secondary" aria-label="Toggle Preview Mode" title="Toggle Preview">üëÅÔ∏è</button>
            <button id="settingsBtn" class="btn btn-secondary" aria-label="Settings">‚öôÔ∏è</button>
            <button id="connectBtn" class="btn btn-primary">Connect</button>
            <button id="printBtn" class="btn btn-primary" disabled>Print</button>
        </div>

        <!-- Settings Popover -->
        <div id="settingsPopover" class="settings-popover">
            <div class="settings-row">
                <label for="printDensity">Print Density (Intensity)</label>
                <div style="display: flex; gap: 8px; align-items: center;">
                    <input type="range" id="printDensity" min="0" max="255" value="93" style="flex:1">
                    <span id="printDensityDisplay" style="font-size: 0.8rem; width: 30px;">93</span>
                </div>
            </div>
            <div class="settings-row">
                <label>Padding (mm)</label>
                <div style="display: flex; gap: 8px;">
                    <div style="flex: 1;">
                         <label for="paddingVertical" style="font-size: 0.7rem; margin-bottom: 2px;">Vertical</label>
                         <input type="number" id="paddingVertical" min="0" max="50" value="5">
                    </div>
                    <div style="flex: 1;">
                         <label for="paddingHorizontal" style="font-size: 0.7rem; margin-bottom: 2px;">Horizontal</label>
                         <input type="number" id="paddingHorizontal" min="0" max="50" value="2">
                    </div>
                </div>
            </div>
            <div class="settings-row">
                <label style="display:flex; align-items:center; gap:8px; cursor:pointer;">
                    <input type="checkbox" id="confirmDeleteOption" checked>
                    Confirm Block Deletion
                </label>
            </div>
             <div class="settings-row">
                <label>Debug</label>
                <div style="display: flex; gap: 8px;">
                    <button id="showLogBtn" class="btn btn-secondary" style="flex: 1; font-size: 0.7rem;">Show Log</button>
                    <button id="clearLogBtn" class="btn btn-secondary" style="flex: 1; font-size: 0.7rem;">Clear</button>
                </div>
            </div>
            <div class="settings-row">
                <label>About</label>
                <div style="font-size: 0.75rem; color: #666; line-height: 1.2;">
                    Thermal Studio<br>
                    MXW01 / Cat Printer Driver
                </div>
            </div>
        </div>
    </header>

    <main>
        <div id="paper-roll">
            <div id="blocksContainer"></div>
            <div id="emptyState" class="empty-state">
                <p>Your canvas is empty.</p>
                <p style="font-size: 0.8rem; margin-top: 8px;">Add blocks to design your print.</p>
            </div>

            <!-- In-Flow Add Controls -->
            <div id="addBlockControls" class="add-block-container">
                <button id="addTextBtn" class="add-btn" aria-label="Add Text Block">
                    <span class="icon">T</span> Text
                </button>
                <button id="addImageBtn" class="add-btn" aria-label="Add Image Block">
                    <span class="icon">üì∑</span> Image
                </button>
                <button id="addQRBtn" class="add-btn" aria-label="Add QR Code Block">
                    <span class="icon">üèÅ</span> QR Code
                </button>
            </div>
        </div>
    </main>

    <!-- Log Drawer -->
    <div id="logBackdrop" class="log-overlay-backdrop"></div>
    <div id="logDrawer" class="log-drawer">
        <div class="log-drawer-header">
            <h2>Printer Log</h2>
            <button id="closeLogBtn" class="btn-icon">√ó</button>
        </div>
        <div class="log-drawer-body">
            <div id="logWrapper" class="log-wrapper"></div>
            <div class="progress-container" id="printProgress">
                <div class="progress-bar" id="printProgressBar"></div>
            </div>
        </div>
    </div>

    <script type="module" src="js/main.js"></script>
</body>
</html>
